<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>HMI CLOUD – Virtual HMI</title>

<style>
body{
  background:#0f172a;
  font-family: Arial;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  color:white;
}

.hmi{
  background:#1e293b;
  width:420px;
  padding:25px;
  border-radius:12px;
  box-shadow:0 0 25px #38bdf8;
}

.title{
  text-align:center;
  font-size:24px;
  margin-bottom:20px;
  color:#38bdf8;
}

/* numeric display */
.display{
  background:black;
  color:#22c55e;
  font-size:64px;
  text-align:right;
  padding:15px;
  border-radius:6px;
  margin-bottom:20px;
  font-family: "Courier New", monospace;
}

/* bar graph */
.bar-box{
  background:#020617;
  height:30px;
  border-radius:6px;
  overflow:hidden;
  margin-bottom:15px;
}

.bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#22c55e,#38bdf8);
  transition:width 0.5s;
}

/* status lamp */
.status{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:18px;
}

.lamp{
  width:18px;
  height:18px;
  border-radius:50%;
  background:red;
  box-shadow:0 0 10px red;
}

.connected{
  background:#22c55e !important;
  box-shadow:0 0 10px #22c55e !important;
}
</style>
</head>

<body>

<div class="hmi">
  <div class="title">HMI CLOUD – VIRTUAL PANEL</div>

  <div id="value" class="display">0</div>

  <div class="bar-box">
    <div id="bar" class="bar"></div>
  </div>

  <div class="status">
    <div id="lamp" class="lamp"></div>
    <div id="statusText">Disconnected</div>
  </div>
</div>

<script>
async function loadData(){
  try{
    const res = await fetch("/data");
    const data = await res.json();

    // numeric
    document.getElementById("value").innerText = data.value;

    // bar (giả sử max = 100)
    let percent = Math.min(data.value,100);
    document.getElementById("bar").style.width = percent + "%";

    // status
    const lamp = document.getElementById("lamp");
    const text = document.getElementById("statusText");

    if(data.status === "Connected"){
      lamp.classList.add("connected");
      text.innerText = "Connected";
    }else{
      lamp.classList.remove("connected");
      text.innerText = "Disconnected";
    }

  }catch(e){
    console.log(e);
  }
}

setInterval(loadData,1000);
</script>

</body>
</html>
