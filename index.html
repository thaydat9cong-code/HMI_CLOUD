<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>HMI CLOUD ‚Äì WinTK Monitor</title>

<style>
body { background:#2b2b2b; font-family:Arial }
#hmi { width:900px; height:500px; background:#e6e6e6; margin:30px auto; border:3px solid #333 }
#titlebar { height:38px; background:#004aad; color:white; line-height:38px; padding-left:10px; font-weight:bold }
#menu { background:#d0d0d0; padding:5px }
#menu button { margin-right:5px; padding:3px 10px }
.screen { display:none; padding:20px }
.screen.active { display:block }
.value-box { width:180px; padding:12px; background:black; color:lime; font-size:30px; text-align:center }
#status { display:flex; align-items:center; margin-top:10px }
#statusDot { width:10px; height:10px; border-radius:50%; background:red; margin-right:8px }
</style>
</head>

<body>

<div id="hmi">
  <div id="titlebar">HMI CLOUD MONITOR (WinTK Style)</div>

  <div id="menu">
    <button onclick="showScreen('s1')">M√†n h√¨nh 1</button>
    <button onclick="showScreen('s2')">M√†n h√¨nh 2</button>
    <button onclick="showScreen('s3')">M√†n h√¨nh 3</button>
  </div>

  <div id="s1" class="screen active">
    <h3>üìü M√ÄN H√åNH CH√çNH (HMI)</h3>
    <div class="value-box" id="hmiValue">---</div>
    <div id="status">
      <div id="statusDot"></div>
      <span id="statusText">Disconnected</span>
    </div>
  </div>

  <div id="s2" class="screen"><h3>‚öôÔ∏è TH√îNG TIN</h3></div>
  <div id="s3" class="screen">
    <h3>üìä GI√ÅM S√ÅT</h3>
    <div class="value-box" id="mirrorValue">---</div>
  </div>
</div>

<script>
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

async function fetchData(){
  try{
    const res = await fetch("/api/status");
    const data = await res.json();
    updateUI(data.hmi_value, data.hmi_connected);
  }catch{
    updateUI(null,false);
  }
}

function updateUI(value, connected){
  hmiValue.innerText = connected ? value : "---";
  mirrorValue.innerText = connected ? value : "---";
  statusText.innerText = connected ? "Connected" : "Disconnected";
  statusDot.style.background = connected ? "lime" : "red";
}

setInterval(fetchData, 1000);
</script>

</body>
</html>
